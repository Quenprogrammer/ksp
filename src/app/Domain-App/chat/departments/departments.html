<app-header-poly></app-header-poly>
<div class="container-fluid content-space-">
  <div class="page-header mt-3">
    <div class="row align-items-center">
      <div class="col content-space-t-2">
        <h1 class="page-header-title mt-2">Departments</h1>
      </div>
      <!-- End Col -->

      <div class="col-auto">

      </div>
      <!-- End Col -->
    </div>
    <!-- End Row -->
  </div>
  <div class="row">
    <div class="col-sm-6 col-lg-3 mb-3 mb-lg-5">
      <!-- Card -->
      <div class="card h-100">
        <div class="card-body">
          <h6 class="card-subtitle mb-2">Total users</h6>

          <div class="row align-items-center gx-2">
            <div class="col">
              <span class="js-counter display-4 text-dark" data-value="24">24</span>
              <span class="text-body fs-5 ms-1">from 22</span>
            </div>
            <!-- End Col -->

            <div class="col-auto">
                  <span class="badge bg-soft-success text-success p-1">
                    <i class="bi-graph-up"></i> 5.0%
                  </span>
            </div>
            <!-- End Col -->
          </div>
          <!-- End Row -->
        </div>
      </div>
      <!-- End Card -->
    </div>

    <div class="col-sm-6 col-lg-3 mb-3 mb-lg-5">
      <!-- Card -->
      <div class="card h-100">
        <div class="card-body">
          <h6 class="card-subtitle mb-2">Active members</h6>

          <div class="row align-items-center gx-2">
            <div class="col">
              <span class="js-counter display-4 text-dark" data-value="12">12</span>
              <span class="text-body fs-5 ms-1">from 11</span>
            </div>

            <div class="col-auto">
                  <span class="badge bg-soft-success text-success p-1">
                    <i class="bi-graph-up"></i> 1.2%
                  </span>
            </div>
          </div>
          <!-- End Row -->
        </div>
      </div>
      <!-- End Card -->
    </div>

    <div class="col-sm-6 col-lg-3 mb-3 mb-lg-5">
      <!-- Card -->
      <div class="card h-100">
        <div class="card-body">
          <h6 class="card-subtitle mb-2">New/returning</h6>

          <div class="row align-items-center gx-2">
            <div class="col">
              <span class="js-counter display-4 text-dark" data-value="56">56</span>
              <span class="display-4 text-dark">%</span>
              <span class="text-body fs-5 ms-1">from 48.7</span>
            </div>

            <div class="col-auto">
                  <span class="badge bg-soft-danger text-danger p-1">
                    <i class="bi-graph-down"></i> 2.8%
                  </span>
            </div>
          </div>
          <!-- End Row -->
        </div>
      </div>
      <!-- End Card -->
    </div>

    <div class="col-sm-6 col-lg-3 mb-3 mb-lg-5">
      <!-- Card -->
      <div class="card h-100">
        <div class="card-body">
          <h6 class="card-subtitle mb-2">Active members</h6>

          <div class="row align-items-center gx-2">
            <div class="col">
              <span class="js-counter display-4 text-dark" data-value="28">28</span>
              <span class="display-4 text-dark">%</span>
              <span class="text-body fs-5 ms-1">from 28.6%</span>
            </div>

            <div class="col-auto">
              <span class="badge bg-soft-secondary text-secondary p-1">0.0%</span>
            </div>
          </div>
          <!-- End Row -->
        </div>
      </div>
      <!-- End Card -->
    </div>
  </div>
  <div class="container-fluid mt-4">


 <div class="card">

 </div>

    <!-- Table -->
    <div class="table-responsive shadow rounded mb-4">
      <input
        type="text"
        placeholder="Search departments..."
        [(ngModel)]="searchTerm"
        (input)="searchDepartments()"
        class="form-control mb-3"
      />

      <table class="table table-striped align-middle text-center">
        <thead class="table-dark">
        <tr>
          <th>Logo</th>
          <th>Name</th>
          <th>Code</th>
          <th>Faculty</th>
          <th>HOD</th>
          <th>Established</th>
          <th>Actions</th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let dept of filteredDepartments">
          <td>
            <img [src]="dept.logo" alt="Logo" width="50" class="rounded-circle" />
          </td>
          <td>{{ dept.departmentName }}</td>
          <td>{{ dept.departmentCode }}</td>
          <td>{{ dept.faculty }}</td>
          <td>{{ dept.headOfDepartment }}</td>
          <td>{{ dept.establishedYear }}</td>
          <td>
            <button
              class="btn btn-sm btn-info me-1"
              (click)="viewDepartment(dept)"
            >
              View
            </button>
            <button
              class="btn btn-sm btn-primary me-1"
              (click)="updateDepartment(dept.id)"
            >
              Update
            </button>
            <button
              class="btn btn-sm btn-warning me-1"
              (click)="disableDepartment(dept.id)"
            >
              Disable
            </button>
            <button
              class="btn btn-sm btn-danger"
              (click)="deleteDepartment(dept.id)"
            >
              Delete
            </button>
          </td>
        </tr>
        </tbody>
      </table>
    </div>

    <!-- Modal -->
    <div
      *ngIf="showModal"
      class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"
    >
      <div class="bg-white p-6 rounded shadow-lg w-96 relative">
        <h3 class="text-xl font-bold mb-4">Department Details</h3>
        <div *ngIf="selectedDept">
          <p><strong>Name:</strong> {{ selectedDept.departmentName }}</p>
          <p><strong>Code:</strong> {{ selectedDept.departmentCode }}</p>
          <p><strong>Faculty:</strong> {{ selectedDept.faculty }}</p>
          <p><strong>Head:</strong> {{ selectedDept.headOfDepartment }}</p>
          <p><strong>Email:</strong> {{ selectedDept.contactEmail }}</p>
          <p><strong>Phone:</strong> {{ selectedDept.phone }}</p>
          <p>
            <strong>Website:</strong>
            <a [href]="selectedDept.website" target="_blank">{{ selectedDept.website }}</a>
          </p>
          <p><strong>Description:</strong> {{ selectedDept.description }}</p>
          <p><strong>Established:</strong> {{ selectedDept.establishedYear }}</p>
          <p><strong>Collection:</strong> {{ selectedDept.collectionName }}</p>
          <p><strong>Created At:</strong> {{ selectedDept.createdAt?.toDate() | date:'medium' }}</p>
        </div>
        <button
          class="mt-4 bg-red-500 text-white px-4 py-2 rounded"
          (click)="closeModal()"
        >
          Close
        </button>
      </div>
    </div>

  </div>

</div>

<!-- End Table -->
