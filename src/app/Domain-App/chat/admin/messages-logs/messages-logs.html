<app-header-poly></app-header-poly>
<div class="container-fluid content-space-2">
  <h3 class="mb-3">Message Attempts</h3>

  <table class="table table-bordered table-striped table-hover">
    <thead class="table-dark">
    <tr>
      <th>Status</th>
      <th>Original Collection</th>
      <th>Original Doc ID</th>
      <th>Error Message</th>
      <th>Attempted At</th>
      <th>Action</th>
    </tr>
    </thead>
    <tbody>
    <tr *ngFor="let attempt of attempts$ | async">
      <td [ngClass]="{'text-success': attempt.status === 'SENT', 'text-danger': attempt.status === 'FAILED'}">
        {{ attempt.status }}
      </td>
      <td>{{ attempt.originalCollection }}</td>
      <td>{{ attempt.originalDocId || 'â€”' }}</td>
      <td>{{ attempt.errorMessage || 'None' }}</td>
      <td>{{ attempt.attemptedAt?.toDate() | date:'medium' }}</td>
      <td>
        <button class="btn btn-sm btn-danger" (click)="deleteAttempt(attempt.id)">Delete</button>
      </td>
    </tr>
    </tbody>
  </table>

  <div *ngIf="(attempts$ | async)?.length === 0" class="alert alert-info">
    No attempts found.
  </div>
</div>
