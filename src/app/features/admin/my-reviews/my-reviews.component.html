<div class="container">
<div class="col">
  <div class="ps-lg-3 ps-xl-0">
    <div class="row align-items-center pb-2 mb-sm-1">
      <div class="col-sm-6 col-md-7 col-xxl-8 mb-3 mb-md-0">
        <h1 class="h2 me-3 mb-0">My reviews</h1>
      </div>
    </div>

    <!-- Loading -->
    <div *ngIf="loading()" class="text-center py-5">
      <lh-loading [message]="'Loading Reviews...'"></lh-loading>
    </div>

    <!-- Error -->
    <div *ngIf="error()" class="alert alert-danger">
      {{ error() }}
    </div>

    <!-- Empty -->
    <div *ngIf="!loading() && reviews.length === 0" class="text-center py-5 text-muted">
      <div class="card border-2 shadow-lg" style="border-radius: 20px;height: 550px">
        <div class="card-body d-flex flex-column justify-content-center align-items-center text-center">
          <lh-no-document></lh-no-document>
        </div>
      </div>
    </div>

    <!-- Reviews List -->
    <div *ngFor="let review of reviews"
         class="d-md-flex align-items-center justify-content-between gap-4 border-bottom py-3"
         (click)="viewReview(review)">
      <div class="nav flex-nowrap position-relative align-items-center">
        <img [src]="review.productImg" class="d-block my-xl-1" width="64" alt="Image">
        <a class="nav-link stretched-link hover-effect-underline ps-3 p-0" [href]="review.productLink">
          {{ review.productName }}
        </a>

      </div>
      {{ review.comment }}
      <div class="position-relative d-flex align-items-center text-decoration-none min-w-0 pt-1 pt-md-0 ps-3 ps-md-0 mb-2 mb-md-0">
        <div class="flex-shrink-0 d-md-none" style="width: 64px"></div>
        <div class="d-flex gap-1 fs-sm me-2 me-sm-3">
          <i *ngFor="let star of getStars(review.rating)" class="ci-star-filled text-warning"></i>
        </div>
        <button class="btn btn-icon btn-ghost btn-secondary stretched-link border-0">
          <i class="ci-chevron-right fs-lg"></i>
        </button>
      </div>
    </div>
  </div>

  <!-- Offcanvas Review -->
  <div *ngIf="openReview()" class="offcanvas offcanvas-end show shadow-lg" style="width: 500px;" aria-modal="true" role="dialog">
    <div class="offcanvas-header py-3 pt-lg-4 border-bottom">
      <h4 class="offcanvas-title">My review</h4>
      <button type="button" class="btn-close" (click)="closeReview()"></button>
    </div>

    <div class="offcanvas-body pt-2" *ngIf="selectedReview() as review">
      <div class="d-flex align-items-center border-bottom mb-4 pb-3">
        <img [src]="review.productImg" width="110" [alt]="review.productName">
        <div class="w-100 min-w-0 ps-2 ps-sm-3">
          <h5 class="d-flex animate-underline mb-2">
            <a class="d-block fs-sm fw-medium text-truncate animate-target" [href]="review.productLink">
              {{ review.productName }}
            </a>
          </h5>
          <div class="h6 mb-0">{{ review.price | currency:'NGN':'symbol':'1.0-0' }}</div>
        </div>
      </div>

      <div class="d-flex align-items-center justify-content-between mb-3">
        <div class="d-flex gap-1 fs-sm me-2 me-sm-3">
          <i *ngFor="let star of getStars(review.rating)" class="ci-star-filled text-warning"></i>
        </div>
        <div class="fs-sm text-body-secondary">{{ review.date }}</div>
      </div>

      <div class="d-flex gap-2 pb-2 mb-1">
        <div class="d-flex fs-sm me-4">
          <span class="fw-medium me-2">Color:</span>{{ review.color }}
        </div>
        <div class="d-flex fs-sm">
          <span class="fw-medium me-2">Model:</span>{{ review.model }}
        </div>
      </div>

      <p class="fs-sm">{{ review.comment }}</p>
      <ul class="list-unstyled fs-sm pb-2 mb-1">
        <li><span class="fw-medium">Pros:</span> {{ review.pros }}</li>
        <li><span class="fw-medium">Cons:</span> {{ review.cons }}</li>
      </ul>

      <!-- Delete Button -->
      <div class="border-top pt-3 mt-3 text-end">
        <button class="btn btn-outline-danger btn-sm" (click)="deleteReview(review)">
          <i class="ci-trash me-2"></i> Delete Review
        </button>
      </div>
    </div>
  </div>
</div>
<div class="d-flex align-items-center justify-content-between pt-4 flex-wrap gap-2">
  <div class="fs-sm d-flex align-items-center flex-wrap gap-1">
    <span>Showing</span>
    <span class="fw-semibold">{{ reviews.length }}</span>
    <span>of</span>
    <span class="fw-semibold">
      <app-doc-counter [collectionPath]="'vendors/' + docId + '/myReview'"></app-doc-counter>
    </span>
    <span class="d-none d-sm-inline">results</span>
  </div>
</div>
</div>
